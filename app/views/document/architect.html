<style>
  .diagram {
    position: relative;
    width: 100%;
    height: 600px;
  }

  .box {
    position: absolute;
    width: 200px;
    background-color: #fff8dc;
    border: 2px solid #f0c040;
    border-radius: 10px;
    padding: 10px;
    text-align: center;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
  }

  /* Vị trí các box */
  .broker {
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
  }
  .firmware {
    top: 100px;
    left: 80px;
  }
  .controller {
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
  }
  .webserver {
    top: 100px;
    right: 80px;
  }

  .note {
    position: absolute;
    top: 50%;
    bottom: 40px;
    right: 130px;
    font-size: 12px;
    color: #333;
    width: 200px;
    text-align: center;
  }

  svg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }

  line {
    stroke: #444;
    stroke-width: 2;
    marker-end: url(#arrowhead);
  }
</style>

<div class="diagram">
  <!-- Mũi tên SVG -->
  <svg>
    <defs>
      <marker
        id="arrowhead"
        markerWidth="10"
        markerHeight="7"
        refX="9"
        refY="3.5"
        orient="auto"
      >
        <polygon points="0 0, 10 3.5, 0 7" fill="#444" />
      </marker>

      <marker
        id="arrowtail"
        markerWidth="10"
        markerHeight="7"
        refX="1"
        refY="3.5"
        orient="auto"
      >
        <polygon points="10 0, 0 3.5, 10 7" fill="#444" />
      </marker>
    </defs>

    <!-- Firmware → Broker -->
    <line
      x1="300"
      y1="260"
      x2="450"
      y2="160"
      marker-start="url(#arrowtail)"
      marker-end="url(#arrowhead)"
    />

    <!-- Broker → Webserver -->
    <line
      x1="670"
      y1="160"
      x2="820"
      y2="200"
      marker-start="url(#arrowtail)"
      marker-end="url(#arrowhead)"
    />

    <!-- Controller → Broker -->
    <line
      x1="550"
      y1="320"
      x2="550"
      y2="190"
      marker-start="url(#arrowtail)"
      marker-end="url(#arrowhead)"
    />

    <!-- Controller → Webserver (future expansion) -->
    <line
      x1="550"
      y1="480"
      x2="830"
      y2="250"
      stroke-dasharray="6,4"
      marker-start="url(#arrowtail)"
      marker-end="url(#arrowhead)"
    />
  </svg>

  <!-- Các khối -->
  <div class="box firmware">
    <strong>Firmware</strong><br />
    MCU and devices that send and receive data to and from the controller
    client.<br />
    Considered as an MQTT client.
  </div>

  <div class="box broker">
    <strong>MQTT Broker</strong><br />
    The MQTT server that serves connections.
  </div>

  <div class="box webserver">
    <strong>Webserver</strong><br />
    The server is for collecting data from the broker, considered as an MQTT
    client.
  </div>

  <div class="box controller">
    <strong>Controller Client</strong><br />
    The software that controls the firmware, considered as an MQTT client.<br />
    This can be a mobile app or desktop app.
  </div>

  <div class="note">
    This connection will be established when the system is expanded. (Future
    use)
  </div>
</div>
